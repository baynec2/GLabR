sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg)
sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
View(sum)
t_7 = all %>%
filter(collection_day == -7)
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g))
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g),color = sample_id)+
geom_point()
p1
t_7 = sum %>%
filter(collection_day == -7)
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g),color = sample_id)+
geom_point()
p1
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g),color = sample_id)+
geom_point()+
scale_y_log10()
p1
ggplot(aes(inc_duration,CFU_mL_g,color = sample_id)+
scale_y_log10()
p1
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g,color = sample_id))+
geom_point()+
scale_y_log10()
p1
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
CFU = GLabR::parse_cfu("../colony_counts.xlsx")
md = read_csv("../metadata.csv")
all = inner_join(CFU,md, by = c("sample_id" = "tube_id"))
sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
t_7 = sum %>%
filter(collection_day == -7)
p1 = t_7 %>%
ggplot(aes(inc_duration,CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
p1 = t_7 %>%
ggplot(aes(as.numeric(inc_duration),CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
p1 = t_7 %>%
group_by(sample_id) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
t_7 = sum %>%
filter(collection_day == -7)
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),CFU_mL_g,color = sample_id))+
geom_point()+
geom_line()+
scale_y_log10()
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10()
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
View(p1)
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10()
p1
?scale_y_log10
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(0,1e11))
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(0, 1e11))
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(0, 1*10^11))
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
ggtitle("CFU Count by time of incubation")
p1
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
ggtitle("CFU Count by time of incubation")+
xlab("Time Incubated")
p1
sum = all %>%
filter(inc_duration ==48)
View(sum)
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
View(sum)
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(sample_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
p1 = sum %>%
ggplot(aes(collection_day, mean))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(collection_day, mean))+
geom_point()+
geom_line()
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(sample_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
View(sum)
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(mouse_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean))
p1
library(tidyverse)
ggplot2::theme_set(ggprism::theme_prism(palette = "viridis"))
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
CFU = GLabR::parse_cfu("../colony_counts.xlsx")
md = read_csv("../metadata.csv")
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(mouse_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
all = inner_join(CFU,md, by = c("sample_id" = "tube_id"))
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(mouse_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = mouse_id))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10()+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
ggtitle("CFU/mL/g over Collection Day")
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
ggtitle("CFU over Collection Day")
p1
library(tidyverse)
ggplot2::theme_set(ggprism::theme_prism(palette = "viridis"))
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
CFU = GLabR::parse_cfu("../colony_counts.xlsx")
md = read_csv("../metadata.csv")
all = inner_join(CFU,md, by = c("sample_id" = "tube_id"))
sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
t_7 = sum %>%
filter(collection_day == -7)
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
ggtitle("CFU Count by time of incubation")+
xlab("Time Incubated")
p1
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(mouse_id,collection_day) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
ggtitle("CFU over Collection Day")
p1
CFU = GLabR::parse_cfu("../colony_counts.xlsx")
md = read_csv("../metadata.csv")
all = inner_join(CFU,md, by = c("sample_id" = "tube_id"))
sum = all %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000))
t_7 = sum %>%
filter(collection_day == -7)
p1 = t_7 %>%
group_by(sample_id,inc_duration) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g)) %>%
ggplot(aes(as.numeric(inc_duration),mean,color = sample_id))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
ggtitle("CFU Count by time of incubation")+
xlab("Time Incubated")
p1
sum = all %>%
filter(inc_duration ==48) %>%
mutate(stool_mg = tube_and_stool_weight - empty_tube_weight_mg,
CFU_mL_g = cfu_mL / (stool_mg /1000)) %>%
group_by(mouse_id,collection_day,treatment_group) %>%
summarise(mean = mean(CFU_mL_g), sd = sd(CFU_mL_g))
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
ggtitle("CFU over Collection Day")
p1
p1 = sum %>%
ggplot(aes(as.numeric(collection_day), mean,color = as.factor(mouse_id)))+
facet_wrap(~treatment_group)+
geom_point()+
geom_line()+
scale_y_log10(limits = c(1,1e11))+
geom_errorbar(aes(ymax = mean + sd, ymin = mean - sd))+
ggtitle("CFU over Collection Day")
p1
d1 = read_csv("../mouse_weights.csv")
View(d1)
View(md)
d2 = inner_join(d1,d2, by = "mouse_id")
d2 = inner_join(d1,md, by = "mouse_id")
p1
p1 = d2 %>%
ggplot(aes(mouse_id,weight_g))+
geom_point()+
facet_wrap(~treatment_group)
p1
p1 = d2 %>%
ggplot(aes(mouse_id,weight_g,color = weight_g))+
geom_col()+
p1
p1
p1 = d2 %>%
ggplot(aes(mouse_id,weight_g,color = weight_g))+
geom_col()
p1
p1 = d2 %>%
ggplot(aes(mouse_id,weight_g,fill = weight_g))+
geom_col()
p1
p1 = d1 %>%
ggplot(aes(mouse_id,weight_g))+
geom_col()
p1
d2 = left_join(d1,md, by = "mouse_id")
p1 = d1 %>%
ggplot(aes(mouse_id,weight_g))+
geom_col()
p1
View(md)
md2 = md %>%
filter(collection_day == 0)
d1 = read_csv("../mouse_weights.csv")
md2 = md %>%
filter(collection_day == 0)
d2 = left_join(d1,md2, by = "mouse_id")
p1 = d1 %>%
ggplot(aes(mouse_id,weight_g))+
geom_col()
p1
p1 = d1 %>%
group_by(treatment_grouo) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g))+
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1
p1 = d1 %>%
group_by(treatment_grouo) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g))+
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1
library(tidyverse)
ggplot2::theme_set(ggprism::theme_prism(palette = "viridis"))
knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)
CFU = GLabR::parse_cfu("../colony_counts.xlsx")
md = read_csv("../metadata.csv")
d1 = read_csv("../mouse_weights.csv")
md2 = md %>%
filter(collection_day == 0)
d2 = left_join(d1,md2, by = "mouse_id")
p1 = d1 %>%
group_by(treatment_grouo) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g))+
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1 = d1 %>%
group_by(treatment_group) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g))+
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1 = d2 %>%
group_by(treatment_group) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g))+
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1 = d2 %>%
group_by(treatment_group) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g)) %>%
ggplot(aes(mouse_id,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1
p1 = d2 %>%
group_by(treatment_group) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g)) %>%
ggplot(aes(treatment_group,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))
p1
d1 = read_csv("../mouse_weights.csv")
md2 = md %>%
filter(collection_day == 0)
d2 = left_join(d1,md2, by = "mouse_id")
p1 = d2 %>%
group_by(treatment_group) %>%
summarise(mean = mean(weight_g), sd = sd(weight_g)) %>%
ggplot(aes(treatment_group,mean))+
geom_col()+
geom_errorbar(aes(ymax =mean + sd, ymin = mean - sd))+
ggtitle("Weight at Day 4")
p1
water = readxl::read_excel("../fluid_consumption.xlsx")
View(water)
p1 = water %>%
ggplot(aes(fluid,amount_drank_mL))+
geom_point()
p1
p1 = water %>%
ggplot(aes(fluid,amount_drank_mL))+
geom_point()+
coord_flip()
p1
p1 = water %>%
filter(fluid != "water") %>%
ggplot(aes(fluid,amount_drank_mL))+
geom_point()+
coord_flip()
p1
p1 = water %>%
filter(fluid != "water") %>%
ggplot(aes(fluid,amount_drank_mL))+
geom_point()+
coord_flip()+
ggtitle("Amount drank at Day 4")
p1
p1 = water %>%
filter(fluid != "water") %>%
ggplot(aes(fluid,amount_drank_mL))+
geom_col()+
coord_flip()+
ggtitle("Amount drank at Day 4")
p1
